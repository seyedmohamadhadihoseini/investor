{"version":3,"sources":["turbopack:///[project]/src/app/page.tsx","turbopack:///[project]/src/app/PersonDataTable.tsx","turbopack:///[project]/src/server/data:068530 <text/javascript>","turbopack:///[project]/src/lib/date/dateUtils.ts","turbopack:///[project]/src/server/data:8bbe1e <text/javascript>"],"sourcesContent":["\"use client\"\nimport { useEffect, useState } from \"react\";\nimport PersonDataTable from \"./PersonDataTable\";\nimport { BankAccount, Contract, Person } from \"@prisma/client\";\nimport { GetAllPeople } from \"@/server\";\nimport { useSelector } from \"react-redux\";\nimport { RootState } from \"@/redux/store\";\n\nexport default function Home() {\n  const [people, setPeople] = useState<(Person & { referrers: Person[] } & { investments: Contract[] } & { bankAccounts: BankAccount[] })[]>([]);\n  const ForceUpdate = useSelector((state: RootState) => state.panel.ForceUpdate);\n  useEffect(() => {\n    GetAllPeople().then(setPeople);\n  }, [ForceUpdate])\n  return (\n    <PersonDataTable people={people} />\n  );\n}","\"use client\"\r\nimport DataListComponent from \"@/components/DataTable\";\r\nimport { RemoveUserServerAction } from \"../server\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { BankAccount, Contract, Person } from \"@prisma/client\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { setDialogObjectId, SetDialogOpen, SetDialogType } from \"@/redux/features/dialog/dialogSlice\";\r\nimport { ShiftDate } from \"@/lib/date/dateUtils\";\r\nimport { makeForceUpdate } from \"@/redux/features/panel/panelSlice\";\r\nexport default function PersonDataTable({ people }: { people: (Person & { referrers: Person[] } & { investments: Contract[] } & { bankAccounts: BankAccount[] })[] }) {\r\n    const router = useRouter()\r\n    const dispatch = useDispatch()\r\n    let minDate = people.map(item => item.createdAt).reduce((acc, item) => {\r\n        if (item.getTime() <= acc) {\r\n            return item.getTime();\r\n        }\r\n        return acc;\r\n    }, Infinity)\r\n    let maxDate = people.map(item => item.createdAt).reduce((acc, item) => {\r\n        if (item.getTime() >= acc) {\r\n            return item.getTime();\r\n        }\r\n        return acc;\r\n    }, 0)\r\n    minDate = minDate == Infinity ? ShiftDate(new Date(), -30).getTime() : minDate;\r\n    maxDate = maxDate == 0 ? ShiftDate(new Date(), 1).getTime() : maxDate;\r\n    const data = people.map(person => ({\r\n        _id: person.id,\r\n        nationalId: person.nationalId,\r\n        FullName: person.FullName,\r\n        investorTotalMoney: person.investments.reduce((acc, item) => acc + item.investmentAmount, 0).toString(),\r\n        refferalCount: person.referrers.length,\r\n        phoneNumber: person.phoneNumber || \"\",\r\n        bankAccount: person.bankAccounts.reduce((acc,curr)=>{\r\n            return `${acc},${curr.number}`\r\n        },\"\") || \"\",\r\n        referrerNationalId: person.parentReferrerId || \"\",\r\n        date: person.createdAt.toISOString(),\r\n        url: `/panel/${person.nationalId}/invest`\r\n    }))\r\n    return (\r\n        <DataListComponent\r\n            headers={[\r\n                { value: \"nationalId\", title: \"کد ملی\" },\r\n                { value: \"FullName\", title: \"نام و نام خانوادگی\" },\r\n                { value: \"investorTotalMoney\", title: \"مجموع سرمایه\" },\r\n                { value: \"refferalCount\", title: \"تعداد افراد معرفی شده\" },\r\n                { value: \"phoneNumber\", title: \"شماره تماس\" },\r\n                { value: \"referrerNationalId\", title: \"کد ملی معرف\" },\r\n                { value: \"date\", title: \"تاریخ عضویت\" },\r\n                { value: \"bankAccount\", title: \"account-number\" },\r\n                { value: \"url\", title: \"url\" },\r\n                { value: \"_id\", title: \"id\" },\r\n            ]}\r\n            data={data}\r\n            ignoreColumnsToShow={[\"bankAccount\"]}\r\n            isShowAddButton\r\n            isShowEditButton\r\n            isShowRemoveButton\r\n            isShowProfile\r\n            editFunction={(id: string) => {\r\n                dispatch(SetDialogOpen(true));\r\n                dispatch(SetDialogType(\"EDIT_PERSON\"));\r\n                dispatch(setDialogObjectId(id));\r\n            }}\r\n            addFunction={() => {\r\n                dispatch(SetDialogOpen(true));\r\n                dispatch(SetDialogType(\"ADD_PERSON\"));\r\n            }}\r\n            removeFunction={async (id: string) => {\r\n                await RemoveUserServerAction(id);\r\n                dispatch(makeForceUpdate());\r\n                router.refresh();\r\n            }}\r\n            onRowClick={() => {\r\n\r\n            }}\r\n            goProfileFunction={(id: string) => {\r\n                window.location.href = `/panel/${(people.filter(person => person.id == id)[0].nationalId)}/invest`\r\n            }}\r\n            filters={[\r\n                { title: \"کد ملی\", columnId: \"nationalId\" },\r\n                { title: \"نام و نام خانوادگی\", columnId: \"FullName\" },\r\n                { title: \"شماره حساب\", columnId: \"bankAccount\" },\r\n                { title: \"میزان سرمایه\", columnId: \"investorTotalMoney\" },\r\n            ]}\r\n            dateFilter={\r\n                {\r\n                    start_date: new Date(minDate),\r\n                    end_date: new Date(maxDate)\r\n                }\r\n            }\r\n        />\r\n    );\r\n}","/* __next_internal_action_entry_do_not_use__ [{\"40da44113965f6f1193a1664934d18712e322289a5\":\"RemoveUserServerAction\"},\"src/server/index.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";export var RemoveUserServerAction=/*#__PURE__*/createServerReference(\"40da44113965f6f1193a1664934d18712e322289a5\",callServer,void 0,findSourceMapURL,\"RemoveUserServerAction\");","export function IsSameDate(_date1: Date, _date2: Date) {\r\n    const date1 = new Date(_date1)\r\n    const date2 = new Date(_date2)\r\n    return date1.getFullYear() == date2.getFullYear() &&\r\n        date1.getMonth() == date2.getMonth() &&\r\n        date1.getDate() == date2.getDate();\r\n}\r\nexport function ShiftDate(_date:Date,day_shift:number){\r\n    const date = new Date(_date) \r\n    date.setDate(date.getDate()+day_shift)\r\n\r\n    return date;\r\n}","/* __next_internal_action_entry_do_not_use__ [{\"00078d01cc677dfd72a61256569ad4f2a15452738a\":\"GetAllPeople\"},\"src/server/index.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";export var GetAllPeople=/*#__PURE__*/createServerReference(\"00078d01cc677dfd72a61256569ad4f2a15452738a\",callServer,void 0,findSourceMapURL,\"GetAllPeople\");"],"names":[],"mappings":"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"}